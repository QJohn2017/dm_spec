#include "eom_header.cc"

int equation_of_motion_run_4( double t, const double y[], double* dy, void* peom )
{
#include "eom_pre.cc"

    dy[0] = -R[0][0] + 2*Ir[1][0]*V[1][0] + 2*Ir[2][0]*V[2][0] + 2*Ir[3][0]*V[3][0];
    dy[1] = -R[1][1] - 2*Ir[1][0]*V[1][0] + 2*Ir[2][1]*V[2][1] + 2*Ir[3][1]*V[3][1];
    dy[2] = -R[2][2] - 2*Ir[2][0]*V[2][0] - 2*Ir[2][1]*V[2][1] + 2*Ir[3][2]*V[3][2];
    dy[3] = -R[3][3] - 2*Ir[3][0]*V[3][0] - 2*Ir[3][1]*V[3][1] - 2*Ir[3][2]*V[3][2];
    dy[4] = -R[1][0] + Ir[2][1]*V[2][0] + Ir[2][0]*V[2][1] + Ir[3][1]*V[3][0] + Ir[3][0]*V[3][1] + Ir[1][0]*w[1][0];
    dy[5] = -(Rr[0][0]*V[1][0]) + Rr[1][1]*V[1][0] + Rr[2][1]*V[2][0] - Rr[2][0]*V[2][1] + Rr[3][1]*V[3][0] - Rr[3][0]*V[3][1] - Rr[1][0]*w[1][0];
    dy[6] = -R[2][0] - Ir[2][1]*V[1][0] + Ir[1][0]*V[2][1] + Ir[3][2]*V[3][0] + Ir[3][0]*V[3][2] + Ir[2][0]*w[2][0];
    dy[7] = Rr[2][1]*V[1][0] - Rr[0][0]*V[2][0] + Rr[2][2]*V[2][0] - Rr[1][0]*V[2][1] + Rr[3][2]*V[3][0] - Rr[3][0]*V[3][2] - Rr[2][0]*w[2][0];
    dy[8] = -R[2][1] - Ir[2][0]*V[1][0] - Ir[1][0]*V[2][0] + Ir[3][2]*V[3][1] + Ir[3][1]*V[3][2] + Ir[2][1]*w[2][1];
    dy[9] = Rr[2][0]*V[1][0] - Rr[1][0]*V[2][0] - Rr[1][1]*V[2][1] + Rr[2][2]*V[2][1] + Rr[3][2]*V[3][1] - Rr[3][1]*V[3][2] - Rr[2][1]*w[2][1];
    dy[10] = -R[3][0] - Ir[3][1]*V[1][0] - Ir[3][2]*V[2][0] + Ir[1][0]*V[3][1] + Ir[2][0]*V[3][2] + Ir[3][0]*w[3][0];
    dy[11] = Rr[3][1]*V[1][0] + Rr[3][2]*V[2][0] - Rr[0][0]*V[3][0] + Rr[3][3]*V[3][0] - Rr[1][0]*V[3][1] - Rr[2][0]*V[3][2] - Rr[3][0]*w[3][0];
    dy[12] = -R[3][1] - Ir[3][0]*V[1][0] - Ir[3][2]*V[2][1] - Ir[1][0]*V[3][0] + Ir[2][1]*V[3][2] + Ir[3][1]*w[3][1];
    dy[13] = Rr[3][0]*V[1][0] + Rr[3][2]*V[2][1] - Rr[1][0]*V[3][0] - Rr[1][1]*V[3][1] + Rr[3][3]*V[3][1] - Rr[2][1]*V[3][2] - Rr[3][1]*w[3][1];
    dy[14] = -R[3][2] - Ir[3][0]*V[2][0] - Ir[3][1]*V[2][1] - Ir[2][0]*V[3][0] - Ir[2][1]*V[3][1] + Ir[3][2]*w[3][2];
    dy[15] = Rr[3][0]*V[2][0] + Rr[3][1]*V[2][1] - Rr[2][0]*V[3][0] - Rr[2][1]*V[3][1] - Rr[2][2]*V[3][2] + Rr[3][3]*V[3][2] - Rr[3][2]*w[3][2];

    return GSL_SUCCESS;
}
